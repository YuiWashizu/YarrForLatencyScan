/*
  MakeHitmapDiff
*/
#include "fromHitTree.h"
#include "TFile.h"
#include "TTree.h"
#include "TH1.h"
#include "TH2.h"
#include "TCanvas.h"
#include <stdio.h>
#include <string>
#include <sstream>
#include <fstream>
#include <iostream>


void MakeHitmapDiff (const std::string& fname = "../rootfile.root") {
  TFile* f = TFile::Open(fname.c_str(), "READ");
  TTree* t = dynamic_cast<TTree*>(f->Get("HitTree"));
  
  fromHitTree event(t);
  int ievent;
  int nevents = t->GetEntries();
  int ihits;
  
  TFile* fout = TFile::Open("Hitmap.root", "RECREATE");
  TH2* h_hitmap = new TH2F("h_hitmap", "", 140, 260, 400, 100, 0, 100);

  for (ievent=0; ievent<nevents; ievent++) {
    event.GetEntry(ievent);
    for (ihits=0; ihits<event.nhits; ++ihits) {
      h_hitmap->Fill(event.hit_col[ihits], event.hit_row[ihits]);
    }
  }
  fout->Write();
  
  TCanvas* c1 = new TCanvas("c1", "c1", 280, 200);
  h_hitmap->Draw("colz");
  c1->SaveAs("HitmapDiff.png");
  
}

